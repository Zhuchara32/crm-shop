"use strict";(self["webpackChunkcrm_shop"]=self["webpackChunkcrm_shop"]||[]).push([[4],{6004:function(e,t,r){r.r(t),r.d(t,{default:function(){return T}});var a=r(3396),n=r(7139);const i={class:"cart"},s=(0,a._)("p",{class:"catalog-link"},"Вернуться к покупкам",-1),l={class:"cart__total"},o={class:"total-app"},c=(0,a._)("p",{class:"total__name"},"Общая сумма:",-1);function d(e,t,r,d,m,u){const _=(0,a.up)("router-link"),p=(0,a.up)("CartItem"),h=(0,a.up)("ModalPurchase");return(0,a.wg)(),(0,a.iD)("div",i,[(0,a.Wm)(_,{class:"catalog",to:"/"},{default:(0,a.w5)((()=>[s])),_:1}),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.cart,((t,r)=>((0,a.wg)(),(0,a.j4)(p,{key:t.uidProd,cart_item_data:t,idx:r,onDeleteFromCart:e=>u.deleteFromCart(r),onIncrementItem:e=>u.increment(r),onDecrementItem:t=>e.decrementItem(r)},null,8,["cart_item_data","idx","onDeleteFromCart","onIncrementItem","onDecrementItem"])))),128)),(0,a._)("div",l,[(0,a._)("div",o,[c,(0,a._)("p",null,(0,n.zw)(u.cartTotalCost+" $"),1)]),(0,a._)("button",{class:"total__btn",onClick:t[0]||(t[0]=(...t)=>e.CHANGE_ActiveModal&&e.CHANGE_ActiveModal(...t))}," Оформить покупку ")]),((0,a.wg)(),(0,a.j4)(a.lR,{to:"body"},[e.isActiveModal?((0,a.wg)(),(0,a.j4)(h,{key:0,cart:e.cart},null,8,["cart"])):(0,a.kq)("",!0)]))])}const m={class:"cart-item"},u=["src"],_={class:"cart-item__app"},p={class:"cart-item__name"},h={class:"cart-item__price"},v={class:"cart-item__description"},y={class:"cart-item__quantity"},C=(0,a._)("p",null,"Количество",-1);function $(e,t,r,i,s,l){return(0,a.wg)(),(0,a.iD)("div",m,[(0,a._)("img",{src:r.cart_item_data.downloadURL,alt:"img",class:"cart-item__img"},null,8,u),(0,a._)("div",_,[(0,a._)("h6",p,(0,n.zw)(r.cart_item_data.nameProd),1),(0,a._)("p",h,(0,n.zw)(r.cart_item_data.price+" $"),1),(0,a._)("p",v,(0,n.zw)(r.cart_item_data.description),1)]),(0,a._)("div",y,[C,(0,a._)("span",null,[(0,a._)("span",{class:"quantity__btn",onClick:t[0]||(t[0]=(...e)=>l.decrementItem&&l.decrementItem(...e))},"-"),(0,a.Uk)(" "+(0,n.zw)(r.cart_item_data.quantity)+" ",1),(0,a._)("span",{class:"quantity__btn",onClick:t[1]||(t[1]=(...e)=>l.incrementItem&&l.incrementItem(...e))},"+")])]),(0,a._)("button",{class:"cart-item__btn",onClick:t[2]||(t[2]=(...e)=>l.deleteFromCart&&l.deleteFromCart(...e))}," Удалить ")])}var w={name:"CartItem",props:{cart_item_data:{type:Object,default(){return{}}}},methods:{deleteFromCart(){this.$emit("deleteFromCart")},decrementItem(){this.$emit("decrementItem")},incrementItem(){this.$emit("incrementItem")}}},g=r(89);const I=(0,g.Z)(w,[["render",$]]);var f=I,E=r(9242);const b={class:"modal"},k={class:"modal-app"},B=(0,a._)("label",{for:"nameBuyer",class:"modal-name"}," Укажите имя покупателя ",-1),A={class:"invalid-list"},D=(0,a._)("label",{for:"addressBuyer",class:"modal-name"}," Укажите адрес доставки ",-1),q={class:"invalid-list"},M=(0,a._)("label",{for:"phoneBuyer",class:"modal-name"}," Укажите номер телефона получателя ",-1),F={class:"invalid-list"},H={class:"modal-container"};function P(e,t,r,i,s,l){return(0,a.wg)(),(0,a.iD)("div",b,[(0,a._)("form",k,[B,(0,a.wy)((0,a._)("input",{type:"text",name:"nameBuyer","onUpdate:modelValue":t[0]||(t[0]=e=>s.nameBuyer=e),class:(0,n.C_)(["modal-input",{invalid:i.v$.nameBuyer.$error}])},null,2),[[E.nr,s.nameBuyer]]),(0,a._)("ul",A,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.v$.nameBuyer.$errors,((e,t)=>((0,a.wg)(),(0,a.iD)("li",{class:"invalid-list__errors",key:t},(0,n.zw)(l.printNameBuyerError(e.$validator,e.$params)),1)))),128))]),D,(0,a.wy)((0,a._)("input",{type:"text",name:"addressBuyer","onUpdate:modelValue":t[1]||(t[1]=e=>s.address=e),class:(0,n.C_)(["modal-input",{invalid:i.v$.address.$error}])},null,2),[[E.nr,s.address]]),(0,a._)("ul",q,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.v$.address.$errors,((e,t)=>((0,a.wg)(),(0,a.iD)("li",{class:"invalid-list__errors",key:t},(0,n.zw)(l.printAddressError(e.$validator,e.$params)),1)))),128))]),M,(0,a.wy)((0,a._)("input",{type:"tel",name:"phoneBuyer","onUpdate:modelValue":t[2]||(t[2]=e=>s.phone=e),class:(0,n.C_)(["modal-input",{invalid:i.v$.phone.$error}])},null,2),[[E.nr,s.phone,void 0,{trim:!0}]]),(0,a._)("ul",F,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.v$.phone.$errors,((e,t)=>((0,a.wg)(),(0,a.iD)("li",{class:"invalid-list__errors",key:t},(0,n.zw)(l.printPhoneError(e.$validator,e.$params)),1)))),128))]),(0,a._)("div",H,[(0,a._)("button",{type:"submit",class:"modal-btn save",onClick:t[3]||(t[3]=(0,E.iM)((e=>l.addInfoSale(r.cart)),["prevent"]))}," Оформить заказ "),(0,a._)("button",{class:"modal-btn cancel",type:"button",onClick:t[4]||(t[4]=(...t)=>e.CHANGE_ActiveModal&&e.CHANGE_ActiveModal(...t))}," Отмена ")])])])}var L=r(3053),z=r(9117),N=r(65),G={name:"ModalPurchase",setup(){return{v$:(0,L.ZP)()}},data(){return{nameBuyer:"",address:"",phone:"",valid:/^\(?(\d{3})\)?[- ]?(\d{3})[- ]?(\d{4})$/}},validations(){return{phone:{phone:e=>this.valid.test(e),required:z.C1,minLength:(0,z.Ei)(10)},nameBuyer:{required:z.C1,minLength:(0,z.Ei)(6)},address:{required:z.C1,minLength:(0,z.Ei)(10)}}},props:{cart:{type:Object,default(){return{}}}},methods:{...(0,N.nv)(["saleProd","CHANGE_ActiveModal"]),async addInfoSale(e){if(this.v$.$touch(),this.v$.$error)return;const t={nameBuyer:this.nameBuyer,address:this.address,phone:this.phone};try{await this.saleProd({cart:e,dataInfo:t}),this.clarInfo(),this.$router.push("/")}catch(r){}},clarInfo(){this.nameBuyer="",this.address="",this.phone=""},printNameBuyerError(e,t){return"required"===e?"Поле не должно быть пустым":"minLength"===e?"Минимальная длина должна быть "+t.min+" символов":void 0},printAddressError(e,t){return"required"===e?"Поле не должно быть пустым":"minLength"===e?"Минимальная длина должна быть "+t.min+" символов":void 0},printPhoneError(e,t){return"required"===e?"Поле не должно быть пустым":"minLength"===e?"Минимальная длина должна быть "+t.min+" символов":"phone"===e?"Введите корректный номер телефона":void 0}}};const j=(0,g.Z)(G,[["render",P]]);var U=j,x={name:"CartView",components:{CartItem:f,ModalPurchase:U},computed:{...(0,N.Se)(["cart","isActiveModal"]),cartTotalCost(){let e=[];if(this.cart.length){for(const t of this.cart)e.push(t.price*t.quantity);return e=e.reduce(((e,t)=>e+t)),e}return 0}},methods:{...(0,N.nv)(["DELETEFromCart","decrementItem","incrementItem","CHANGE_ActiveModal"]),deleteFromCart(e){this.DELETEFromCart(e)},increment(e){this.incrementItem(e),this.cart[e].quantity===this.cart[e].count&&this.$message("У данного продавца не хватает товара на складе")}}};const K=(0,g.Z)(x,[["render",d]]);var T=K}}]);
//# sourceMappingURL=4.fbf3055a.js.map